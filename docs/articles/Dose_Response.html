<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="easyXpress">
<title>Dose Response Processing • easyXpress</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Dose Response Processing">
<meta property="og:description" content="easyXpress">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">easyXpress</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/easyXpress.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Dose_Response.html">Dose Response Processing</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Dose Response Processing</h1>
            
      
      
      <div class="d-none name"><code>Dose_Response.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><strong>easyXpress</strong> is an R package to read, process, and analyze worm morphology data acquired with the <a href="https://github.com/AndersenLab/cellprofiler-nf" class="external-link"><code>cellprofiler-nf</code></a> nextflow pipeline.</p>
<p>Below is a detailed walk through applying the easyXpress package to sample dose response data extracted from a toxicant dose response article published in the journal <a href="https://www.sciencedirect.com/science/article/pii/S0300483X22002049?via%3Dihub" class="external-link">Toxicology</a>.</p>
<p>There are four major steps to processing dose response data that are described in detail below.</p>
<p><strong>1. Load Data</strong> - Read in CellProfiler data and select the appropriate models for primary objects.<br><strong>2. Flag Objects</strong> - Flag, check, and filter problematic objects, then summarize object data within wells.<br><strong>3. Flag Wells</strong> - Flag, check, and filter problematic wells, then check experimental design balance after filtering.<br><strong>4. Finalize Results</strong> - Calculate control delta’s and regress confounding effects if needed.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://andersenlab.org/easyXpress/" class="external-link">easyXpress</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="get-example-dose-response-data">Get example dose response data<a class="anchor" aria-label="anchor" href="#get-example-dose-response-data"></a>
</h3>
<p>This article will use example data that exceeds the typical size for package vignettes, to recreate the workflow below clone the example data from the <code>AndersenLab/eXDR</code> repository.</p>
<p>To clone the example data, users will need to have <code>git</code> installed on their machine. Follow the <a href="https://github.com/git-guides/install-git" class="external-link">instructions here</a> if you don’t have <code>git</code> installed or are unsure.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># specify a directory to clone the example data repository to. Here we'll clone</span></span>
<span><span class="co"># it to the Desktop. You can use whatever path your like here, just make sure it</span></span>
<span><span class="co"># is valid and ends in /</span></span>
<span><span class="va">ex.dir</span> <span class="op">&lt;-</span> <span class="st">"~/Desktop/"</span> </span>
<span></span>
<span><span class="co"># clone the repo using a system command</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.html" class="external-link">system</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"git clone https://github.com/AndersenLab/eXDR.git "</span>,</span>
<span>              <span class="va">ex.dir</span>,</span>
<span>              <span class="st">"eXDR"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="load-data">Load Data<a class="anchor" aria-label="anchor" href="#load-data"></a>
</h2>
<p>Read in CellProfiler data and select the appropriate models for primary objects.</p>
<div class="section level3">
<h3 id="readxpress">
<code>readXpress</code><a class="anchor" aria-label="anchor" href="#readxpress"></a>
</h3>
<p>This function reads data output from <code>cellprofiler-nf</code> into R.</p>
<p><code><a href="../reference/readXpress.html">readXpress()</a></code> takes one or more paths to project directories that hold data exported from <code>cellprofiler-nf</code>. Each project directory must have CellProfiler data in a sub-folder named <code>cp_data</code>. Set the <code>rdafile</code> argument to the name of the files you plan to use, one per project. If <code>design = TRUE</code>, a design file will be joined. The design file should be located in a sub-folder of the experimental directory named <code>design</code>. To process dose response data, users must set <code>doseR = TRUE</code>. The other arguments are specified by default but can be adjusted if needed.</p>
<p>For more information regarding project directory structure, see <a href="https://github.com/AndersenLab/easyXpress" class="external-link"><code>R/easyXpress</code></a>.</p>
<p>If <code>design = T</code> the <code><a href="../reference/readXpress.html">readXpress()</a></code> function returns a list, with the first element named <code>raw_data</code> and the second named <code>design</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># make a vector of project directories cloned in the example data (eXDR)</span></span>
<span><span class="va">filedirs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">ex.dir</span>, <span class="st">"eXDR"</span>, <span class="st">"/20201210_toxin14A"</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">ex.dir</span>, <span class="st">"eXDR"</span>, <span class="st">"/20201217_toxin15A"</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">ex.dir</span>, <span class="st">"eXDR"</span>, <span class="st">"/20210311_toxin22A"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># make a vector of the .RData files cloned in the example data (eXDR)</span></span>
<span><span class="va">rdafiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"20201210_toxin14A_Analysis-20231003.RData"</span>,</span>
<span>              <span class="st">"20201217_toxin15A_Analysis-20231003.RData"</span>,</span>
<span>              <span class="st">"20210311_toxin22A_Analysis-20231003.RData"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Read in the data</span></span>
<span><span class="va">dr</span> <span class="op">&lt;-</span> <span class="fu">easyXpress</span><span class="fu">::</span><span class="fu"><a href="../reference/readXpress.html">readXpress</a></span><span class="op">(</span>filedir <span class="op">=</span> <span class="va">filedirs</span>,</span>
<span>                             rdafile <span class="op">=</span> <span class="va">rdafiles</span>,</span>
<span>                             design <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                             doseR <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">#&gt; You set doseR = TRUE. Reading data as a dose response.</span></span>
<span><span class="co">#&gt; 3 projects detected:</span></span>
<span><span class="co">#&gt; loading data from 3 .rda files:</span></span>
<span><span class="co">#&gt; loading ~/Desktop/eXDR/20201210_toxin14A/cp_data/20201210_toxin14A_Analysis-20231003.RData</span></span>
<span><span class="co">#&gt; loading ~/Desktop/eXDR/20201217_toxin15A/cp_data/20201217_toxin15A_Analysis-20231003.RData</span></span>
<span><span class="co">#&gt; loading ~/Desktop/eXDR/20210311_toxin22A/cp_data/20210311_toxin22A_Analysis-20231003.RData</span></span>
<span><span class="co">#&gt; Applying length threshold of 98.811 um.</span></span>
<span><span class="co">#&gt; The number of filtered rows for each model are displayed below.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |model              | filtered| total_rows|</span></span>
<span><span class="co">#&gt; |:------------------|--------:|----------:|</span></span>
<span><span class="co">#&gt; |L1_N2_HB101_100w   |       78|      14091|</span></span>
<span><span class="co">#&gt; |L2L3_N2_HB101_100w |        0|       8108|</span></span>
<span><span class="co">#&gt; |L4_N2_HB101_100w   |        0|       4062|</span></span>
<span><span class="co">#&gt; |MDHD               |     6945|      29763|</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Applying missing parent filter.</span></span>
<span><span class="co">#&gt; The number of filtered rows for each model are displayed below.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |model              | filtered| total_rows|</span></span>
<span><span class="co">#&gt; |:------------------|--------:|----------:|</span></span>
<span><span class="co">#&gt; |L1_N2_HB101_100w   |       12|      14091|</span></span>
<span><span class="co">#&gt; |L2L3_N2_HB101_100w |        0|       8108|</span></span>
<span><span class="co">#&gt; |L4_N2_HB101_100w   |        0|       4062|</span></span>
<span><span class="co">#&gt; |MDHD               |        5|      29763|</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Primary object attributes detected.</span></span>
<span><span class="co">#&gt; Calculating `wo_po_area_frac`.</span></span>
<span><span class="co">#&gt; joining design file:</span></span>
<span><span class="co">#&gt; ~/Desktop/eXDR/20201210_toxin14A/design/toxin14A_design.csv</span></span>
<span><span class="co">#&gt; joining design file:</span></span>
<span><span class="co">#&gt; ~/Desktop/eXDR/20201217_toxin15A/design/toxin15A_design.csv</span></span>
<span><span class="co">#&gt; joining design file:</span></span>
<span><span class="co">#&gt; ~/Desktop/eXDR/20210311_toxin22A/design/toxin22A_design.csv</span></span>
<span><span class="co">#&gt; DONE</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="modelselection">
<code>modelSelection</code><a class="anchor" aria-label="anchor" href="#modelselection"></a>
</h3>
<p><code><a href="../reference/modelSelection.html">modelSelection()</a></code> takes the raw data output from the <code><a href="../reference/readXpress.html">readXpress()</a></code> function. It will assign the appropriate CellProfiler model to each primary object in the data frame.</p>
<p>To access the raw data output from the <code><a href="../reference/readXpress.html">readXpress()</a></code> function call above, we can use <code>dr$raw_data</code>.</p>
<p>In this example, the data was generated using 4 worm models (MDHD, L1, L2L3, and L4).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The modelSelection function to select the best model for each primary object</span></span>
<span><span class="va">ms</span> <span class="op">&lt;-</span> <span class="fu">easyXpress</span><span class="fu">::</span><span class="fu"><a href="../reference/modelSelection.html">modelSelection</a></span><span class="op">(</span><span class="va">dr</span><span class="op">$</span><span class="va">raw_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; Removing unnecessary '.model.outputs' suffix from model names</span></span>
<span><span class="co">#&gt; Found 4 worm models in data.</span></span>
<span><span class="co">#&gt; MDHD</span></span>
<span><span class="co">#&gt; L1_N2_HB101_100w</span></span>
<span><span class="co">#&gt; L2L3_N2_HB101_100w</span></span>
<span><span class="co">#&gt; L4_N2_HB101_100w</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="flag-objects">Flag Objects<a class="anchor" aria-label="anchor" href="#flag-objects"></a>
</h2>
<p>This step of the project processing will flag problematic objects in the data using various <code>ObjectFlag</code> functions (OF)s. Users can filter flags or retain them after they have been checked.</p>
<div class="section level3">
<h3 id="edgeof-and-clusterof">
<code>edgeOF</code> and <code>clusterOF</code><a class="anchor" aria-label="anchor" href="#edgeof-and-clusterof"></a>
</h3>
<p>The <code><a href="../reference/edgeOF.html">edgeOF()</a></code> function will flag objects close to the edge of the well that are difficult to segment properly.</p>
<p>The <code><a href="../reference/clusterOF.html">clusterOF()</a></code> function will flag any objects that are found within the same primary object. These ‘clusters’ are often debris or improperly segmented worms.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use the edgeOF fucntion</span></span>
<span><span class="va">ef</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/edgeOF.html">edgeOF</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ms</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use the clusterOF function</span></span>
<span><span class="va">cf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clusterOF.html">clusterOF</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ef</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="checkof">
<code>checkOF</code><a class="anchor" aria-label="anchor" href="#checkof"></a>
</h3>
<p>Use the <code><a href="../reference/checkOF.html">checkOF()</a></code> function to see how the object flags look across the desired grouping variables, which are specified with <code>...</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">c1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/checkOF.html">checkOF</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cf</span>, <span class="va">drug</span>, <span class="va">concentration_um</span><span class="op">)</span></span>
<span><span class="co">#&gt; 2 ObjectFlags detected in data. They were applied in the following order:</span></span>
<span><span class="co">#&gt; edge_ObjectFlag</span></span>
<span><span class="co">#&gt; cluster_ObjectFlag</span></span>
<span><span class="co">#&gt; The data are summarized by: drug, concentration_um</span></span>
<span><span class="co">#&gt; Returning list with elements d (the summary data frame) and p (the summary plot)</span></span>
<span></span>
<span><span class="co"># loop at the plot returned</span></span>
<span><span class="va">c1</span><span class="op">$</span><span class="va">p</span></span></code></pre></div>
<p><img src="Dose_Response_files/figure-html/unnamed-chunk-6-1.png" width="960" style="display: block; margin: auto;"><br> The <code>checkOF</code> plot above shows that there are a lot of objects and many clusters at the higher concentrations of Zinc, which suggests a problem at these concentrations.</p>
</div>
<div class="section level3">
<h3 id="checkobjs">
<code>checkObjs</code><a class="anchor" aria-label="anchor" href="#checkobjs"></a>
</h3>
<p>Use the <code><a href="../reference/checkObjs.html">checkObjs()</a></code> function to visualize the size distributions of the objects by grouping variables.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Show just the noFlag data by setting OF = "filter"</span></span>
<span><span class="va">c2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/checkObjs.html">checkObjs</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cf</span>, OF <span class="op">=</span> <span class="st">'filter'</span>, <span class="va">drug</span>, <span class="va">concentration_um</span><span class="op">)</span></span>
<span><span class="co">#&gt; 2 ObjectFlags detected in data. They were applied in the following order:</span></span>
<span><span class="co">#&gt; edge_ObjectFlag</span></span>
<span><span class="co">#&gt; cluster_ObjectFlag</span></span>
<span><span class="co">#&gt; The flagged objects will be filtered from the plot.</span></span>
<span></span>
<span><span class="co"># look at the plot returned</span></span>
<span><span class="va">c2</span></span></code></pre></div>
<p><img src="Dose_Response_files/figure-html/unnamed-chunk-7-1.png" width="1152" style="display: block; margin: auto;"><br> The diagnostic plot made with the <code><a href="../reference/checkObjs.html">checkObjs()</a></code> function above shows a strong bimodal distribution in the higher concentrations of zinc that further suggest a problem - probably debris in wells.</p>
</div>
<div class="section level3">
<h3 id="checkmodels">
<code>checkModels</code><a class="anchor" aria-label="anchor" href="#checkmodels"></a>
</h3>
<p>The <code><a href="../reference/checkModels.html">checkModels()</a></code> function is used to see if small objects are debris. This function will produce diagnostic plots across grouping variables. The default settings help decide whether to use a 100um (30px) or 165um (50px) size filter for objects, and whether to use the <code>MDHD</code> worm model or not. Use <code>?checkModels()</code> for more help if needed.</p>
<p>Before the <code><a href="../reference/checkModels.html">checkModels()</a></code> function is used, a variable that specifies the PATH to the processed images for each project is needed. Below, the <code>dplyr</code> package is used to add that variable and make a well label to include in the diagnostic overlays.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add variables that describe the PATH to processed images and well labels</span></span>
<span><span class="va">cm</span> <span class="op">&lt;-</span> <span class="va">cf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># add img dir var</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>i.dir <span class="op">=</span></span>
<span>                  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">Metadata_Experiment</span> <span class="op">==</span> <span class="st">"toxin14A"</span> <span class="op">~</span></span>
<span>                                           <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">ex.dir</span>, <span class="st">"eXDR/20201210_toxin14A/processed_images/"</span><span class="op">)</span>,</span>
<span>                                         <span class="va">Metadata_Experiment</span> <span class="op">==</span> <span class="st">"toxin15A"</span> <span class="op">~</span></span>
<span>                                           <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">ex.dir</span>, <span class="st">"eXDR/20201217_toxin15A/processed_images/"</span><span class="op">)</span>,</span>
<span>                                         <span class="va">Metadata_Experiment</span> <span class="op">==</span> <span class="st">"toxin22A"</span> <span class="op">~</span></span>
<span>                                           <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">ex.dir</span>, <span class="st">"eXDR/20210311_toxin22A/processed_images/"</span><span class="op">)</span>,</span>
<span>                                         <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">NA_character_</span><span class="op">)</span>,</span>
<span>                <span class="co"># add well label var</span></span>
<span>                w.lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">drug</span>, <span class="va">strain</span>, <span class="va">concentration_um</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># use the checkModels function</span></span>
<span><span class="va">cm.out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/checkModels.html">checkModels</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cm</span>,</span>
<span>                      <span class="co"># the grouping vars (...), make a plot for each.</span></span>
<span>                      <span class="va">Metadata_Experiment</span>, <span class="va">drug</span>,</span>
<span>                      proc.img.dir <span class="op">=</span> <span class="st">"i.dir"</span>,</span>
<span>                      well.label <span class="op">=</span> <span class="st">"w.lab"</span>,</span>
<span>                       <span class="co"># save in the repo you cloned</span></span>
<span>                      out.dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">ex.dir</span>, <span class="st">"eXDR/checkModels/out"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Filtering flagged objects from data.</span></span>
<span><span class="co">#&gt; 2 ObjectFlags detected in data. They were applied in the following order:</span></span>
<span><span class="co">#&gt; edge_ObjectFlag</span></span>
<span><span class="co">#&gt; cluster_ObjectFlag</span></span>
<span><span class="co">#&gt; Making grob list for 8 overlays</span></span>
<span><span class="co">#&gt; Making plot for 8 overlays</span></span>
<span><span class="co">#&gt; Saving plot as: ~/Desktop/eXDR/checkModels/out/toxin14A_Paraquat.png</span></span>
<span><span class="co">#&gt; Making grob list for 8 overlays</span></span>
<span><span class="co">#&gt; Making plot for 8 overlays</span></span>
<span><span class="co">#&gt; Saving plot as: ~/Desktop/eXDR/checkModels/out/toxin14A_Zinc dichloride.png</span></span>
<span><span class="co">#&gt; Making grob list for 8 overlays</span></span>
<span><span class="co">#&gt; Making plot for 8 overlays</span></span>
<span><span class="co">#&gt; Saving plot as: ~/Desktop/eXDR/checkModels/out/toxin15A_Zinc dichloride.png</span></span>
<span><span class="co">#&gt; Making grob list for 8 overlays</span></span>
<span><span class="co">#&gt; Making plot for 8 overlays</span></span>
<span><span class="co">#&gt; Saving plot as: ~/Desktop/eXDR/checkModels/out/toxin15A_Paraquat.png</span></span>
<span><span class="co">#&gt; Making grob list for 8 overlays</span></span>
<span><span class="co">#&gt; Making plot for 8 overlays</span></span>
<span><span class="co">#&gt; Saving plot as: ~/Desktop/eXDR/checkModels/out/toxin22A_Paraquat.png</span></span>
<span><span class="co">#&gt; Making grob list for 8 overlays</span></span>
<span><span class="co">#&gt; Making plot for 8 overlays</span></span>
<span><span class="co">#&gt; Saving plot as: ~/Desktop/eXDR/checkModels/out/toxin22A_Zinc dichloride.png</span></span>
<span><span class="co">#&gt; DONE</span></span></code></pre></div>
<div class="figure">
<img src="checkModels_ex_anno.png" alt="**checkModels() output for Zinc dichloride** - The MDHD objects are all junk or improperly segemnted worms, objects &lt; 165um are also problematic. These objects should be filtered. The large inset overlaid on the right of this plot is provided to show the objects in more detail, it is not included in the acutal function output." width="1915"><p class="caption">
<strong>checkModels() output for Zinc dichloride</strong> - The MDHD objects are all junk or improperly segemnted worms, objects &lt; 165um are also problematic. These objects should be filtered. The large inset overlaid on the right of this plot is provided to show the objects in more detail, it is not included in the acutal function output.
</p>
</div>
<p><br> Based on the diagnostic plots from the <code><a href="../reference/checkModels.html">checkModels()</a></code> function, like the example above, the following filters should be applied for each drug:<br><strong>1. Zinc dichloride</strong> - Remove all objects identified by the MDHD model and remove objects with a <code>worm_length_um</code> &lt; 165um.<br><strong>2. Paraquat</strong> - Use the MDHD model for paraquat, but remove out objects with a <code>worm_length_um</code> &lt; 165um. There is no example shown for paraquat, but you can see the plots in your example directory for yourself.</p>
</div>
<div class="section level3">
<h3 id="userof">
<code>userOF</code><a class="anchor" aria-label="anchor" href="#userof"></a>
</h3>
<p>Use the <code><a href="../reference/userOF.html">userOF()</a></code> function to add the size and model flags to the data as an easyXpress compatible object flag. The variable added can be named anything. In this example, it is named ‘user’ and passed to the <code>userOF</code> function through <code>...</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># add the user variable that will be converted to an object flag</span></span>
<span><span class="va">u</span> <span class="op">=</span> <span class="va">cm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>user <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">drug</span> <span class="op">==</span> <span class="st">"Zinc dichloride"</span> <span class="op">&amp;</span></span>
<span>                                          <span class="va">model</span> <span class="op">==</span> <span class="st">"MDHD"</span> <span class="op">~</span> <span class="st">"junk"</span>,</span>
<span>                                        <span class="va">drug</span> <span class="op">==</span> <span class="st">"Zinc dichloride"</span> <span class="op">&amp;</span></span>
<span>                                          <span class="va">worm_length_um</span> <span class="op">&lt;</span> <span class="fl">165</span> <span class="op">~</span> <span class="st">"junk"</span>,</span>
<span>                                        <span class="va">drug</span> <span class="op">==</span> <span class="st">"Paraquat"</span> <span class="op">&amp;</span></span>
<span>                                          <span class="va">worm_length_um</span> <span class="op">&lt;</span> <span class="fl">165</span> <span class="op">~</span> <span class="st">"junk"</span>,</span>
<span>                                        <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">NA_character_</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Run the userOF function and specify user variable as the flag</span></span>
<span><span class="va">uf</span> <span class="op">&lt;-</span> <span class="fu">easyXpress</span><span class="fu">::</span><span class="fu"><a href="../reference/userOF.html">userOF</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">u</span>, <span class="va">user</span><span class="op">)</span></span>
<span><span class="co">#&gt; Converting user into an easyXpress compatible object flag (OF).</span></span>
<span></span>
<span><span class="co"># Check the object data again to see if the bimodal distributions are resolved.</span></span>
<span><span class="fu"><a href="../reference/checkObjs.html">checkObjs</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">uf</span>, OF <span class="op">=</span> <span class="st">"filter"</span>, <span class="va">drug</span>, <span class="va">concentration_um</span><span class="op">)</span></span>
<span><span class="co">#&gt; 3 ObjectFlags detected in data. They were applied in the following order:</span></span>
<span><span class="co">#&gt; edge_ObjectFlag</span></span>
<span><span class="co">#&gt; cluster_ObjectFlag</span></span>
<span><span class="co">#&gt; user_ObjectFlag</span></span>
<span><span class="co">#&gt; The flagged objects will be filtered from the plot.</span></span></code></pre></div>
<p><img src="Dose_Response_files/figure-html/unnamed-chunk-10-1.png" width="1152" style="display: block; margin: auto;"><br> The diagnostic plot made with the <code><a href="../reference/checkObjs.html">checkObjs()</a></code> function above shows that the bimodal distribution in the higher concentrations of zinc are improved by adding the user object flag.</p>
</div>
<div class="section level3">
<h3 id="classifierof">
<code>classifierOF</code><a class="anchor" aria-label="anchor" href="#classifierof"></a>
</h3>
<p>The <code>classiferOF()</code> function will flag objects that are likely debris or improperly segmented worms. Currently, this function should only be used on 2X images obtained with the ImageXpress Nano and run through the most recent release of the <code>cellprofiler-nf</code> nextflow pipeline.</p>
<p>Any objects with <code>NA</code> for the data variables used by the classifier will be flagged in the output. These are rare, and often problematic to begin with. Check the function output to see how many objects are being flagged as <code>NA</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># apply the classifierOF function</span></span>
<span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/classifierOF.html">classifierOF</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">uf</span><span class="op">)</span></span>
<span><span class="co">#&gt; WARNING: There are 2 rows with NAs in one or more object variables used for the classifier. These rows are flagged as "classErr" in the output.</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="outlierof">
<code>outlierOF</code><a class="anchor" aria-label="anchor" href="#outlierof"></a>
</h3>
<p>The <code>outlierOF</code> function will flag objects that have extreme <code>worm_length_um</code> values relative to the other objects in the same well.</p>
<p>The <code>outlierOF</code> function should be applied after all other object flags have been set. This is because the function ignores previously flagged data when searching for outliers in the well.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># apply the outlierOF function</span></span>
<span><span class="va">o</span> <span class="op">&lt;-</span> <span class="fu">easyXpress</span><span class="fu">::</span><span class="fu"><a href="../reference/outlierOF.html">outlierOF</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cl</span><span class="op">)</span></span>
<span><span class="co">#&gt; Previously flagged objects will not be used when calcualting outliers. This is the recommended approach.</span></span>
<span><span class="co">#&gt; 4 ObjectFlags detected in data. They were applied in the following order:</span></span>
<span><span class="co">#&gt; edge_ObjectFlag</span></span>
<span><span class="co">#&gt; cluster_ObjectFlag</span></span>
<span><span class="co">#&gt; user_ObjectFlag</span></span>
<span><span class="co">#&gt; classifier_ObjectFlag</span></span>
<span><span class="co">#&gt; Flagging outlier objects in each well if worm_length_um is outside the range: median +/- (1.5*IQR)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="checkobjs-1">
<code>checkObjs</code><a class="anchor" aria-label="anchor" href="#checkobjs-1"></a>
</h3>
<p>Use the <code><a href="../reference/checkObjs.html">checkObjs()</a></code> function again to check the effect of filtering all the object flags. Any strong multi-modal signals that remain in the data should be reviewed to ensure they are the result of biology rather than anomalous features of the well image.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># check objects again, notice how there are 5 ObjectFlags detected now.</span></span>
<span><span class="fu"><a href="../reference/checkObjs.html">checkObjs</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">o</span>, OF <span class="op">=</span> <span class="st">'filter'</span>, <span class="va">drug</span>, <span class="va">concentration_um</span><span class="op">)</span></span>
<span><span class="co">#&gt; 5 ObjectFlags detected in data. They were applied in the following order:</span></span>
<span><span class="co">#&gt; edge_ObjectFlag</span></span>
<span><span class="co">#&gt; cluster_ObjectFlag</span></span>
<span><span class="co">#&gt; user_ObjectFlag</span></span>
<span><span class="co">#&gt; classifier_ObjectFlag</span></span>
<span><span class="co">#&gt; outlier_ObjectFlag</span></span>
<span><span class="co">#&gt; The flagged objects will be filtered from the plot.</span></span></code></pre></div>
<p><img src="Dose_Response_files/figure-html/unnamed-chunk-13-1.png" width="1152" style="display: block; margin: auto;"><br> The plot above looks much better than it did for the raw data. For example, the bimodal distributions at the high concentrations of Zinc are largely removed.</p>
</div>
<div class="section level3">
<h3 id="checkof-1">
<code>checkOF</code><a class="anchor" aria-label="anchor" href="#checkof-1"></a>
</h3>
<p>Use the <code>checkOF</code> function again to see how much data is being flagged. If certain conditions in the experiment are heavily flagged it suggests that those data may not be worth keeping.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># check object flags again</span></span>
<span><span class="va">co2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/checkOF.html">checkOF</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">o</span>, <span class="va">drug</span>, <span class="va">concentration_um</span><span class="op">)</span></span>
<span><span class="co">#&gt; 5 ObjectFlags detected in data. They were applied in the following order:</span></span>
<span><span class="co">#&gt; edge_ObjectFlag</span></span>
<span><span class="co">#&gt; cluster_ObjectFlag</span></span>
<span><span class="co">#&gt; user_ObjectFlag</span></span>
<span><span class="co">#&gt; classifier_ObjectFlag</span></span>
<span><span class="co">#&gt; outlier_ObjectFlag</span></span>
<span><span class="co">#&gt; The data are summarized by: drug, concentration_um</span></span>
<span><span class="co">#&gt; Returning list with elements d (the summary data frame) and p (the summary plot)</span></span>
<span></span>
<span><span class="co"># check the plot</span></span>
<span><span class="va">co2</span><span class="op">$</span><span class="va">p</span></span></code></pre></div>
<p><img src="Dose_Response_files/figure-html/unnamed-chunk-14-1.png" width="1152" style="display: block; margin: auto;"><br> There are many flagged objects for high concentration of zinc. This is somewhat expected since the wells appear to have a lot of junk in them.</p>
<p>The <code><a href="../reference/viewOverlay.html">viewOverlay()</a></code> function can be used to check these wells and see if the flags are working properly whether the data are worth keeping.</p>
</div>
<div class="section level3">
<h3 id="viewoverlay">
<code>viewOverlay</code><a class="anchor" aria-label="anchor" href="#viewoverlay"></a>
</h3>
<p>The <code><a href="../reference/viewOverlay.html">viewOverlay()</a></code> function will annotate the diagnostic images output from <code>cellprofiler-nf</code> with any desired object data. This function is extremely useful for troubleshooting problematic conditions in an experiment. Since this function will build an array of full size images, we recommend sub-setting the data to 48 wells or less to reduce file sizes.</p>
<p>The <code><a href="../reference/setOF.html">setOF()</a></code> function can be used to help annotate object flags. In the example below, the <code><a href="../reference/setOF.html">setOF()</a></code> function is used to collapse the five <code>_ObjectFlag</code> variables to a single variable named <code>objectFlag</code>, which we will use to annotate the overlays. The <code>dplyr</code> package is also used to filter the data to problematic conditions and randomly sample eight wells to pass to the <code><a href="../reference/viewOverlay.html">viewOverlay()</a></code> function.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># IMPORTANT! set the seed to ensure the 8 random wells</span></span>
<span><span class="co"># are found in the example images</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">99</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># set the flags and filter data</span></span>
<span><span class="va">o2</span> <span class="op">&lt;-</span> <span class="fu">easyXpress</span><span class="fu">::</span><span class="fu"><a href="../reference/setOF.html">setOF</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">o</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># set the flags</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">drug</span> <span class="op">==</span> <span class="st">"Zinc dichloride"</span> <span class="op">&amp;</span></span>
<span>                  <span class="va">concentration_um</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">400</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co">#randomly sample 8 wells</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">well.id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">well.id</span>, size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; 5 ObjectFlags detected in data. They were applied in the following order:</span></span>
<span><span class="co">#&gt; edge_ObjectFlag</span></span>
<span><span class="co">#&gt; cluster_ObjectFlag</span></span>
<span><span class="co">#&gt; user_ObjectFlag</span></span>
<span><span class="co">#&gt; classifier_ObjectFlag</span></span>
<span><span class="co">#&gt; outlier_ObjectFlag</span></span>
<span><span class="co">#&gt; The flagged objects are labelled in the objectFlag variable.</span></span>
<span></span>
<span><span class="co"># Use the viewOverlay function</span></span>
<span><span class="va">vo1</span> <span class="op">&lt;-</span> <span class="fu">easyXpress</span><span class="fu">::</span><span class="fu"><a href="../reference/viewOverlay.html">viewOverlay</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">o2</span>,</span>
<span>                        proc.img.dir <span class="op">=</span> <span class="st">"i.dir"</span>,</span>
<span>                        well.label <span class="op">=</span> <span class="st">"w.lab"</span>,</span>
<span>                        obj.label <span class="op">=</span> <span class="st">"model"</span>,</span>
<span>                        text.anno <span class="op">=</span> <span class="st">"objectFlag"</span>,</span>
<span>                        <span class="co"># save to example dir</span></span>
<span>                        file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">ex.dir</span>, <span class="st">"eXDR/viewOverlay/overlay1.png"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Making grob list for 8 overlays</span></span>
<span><span class="co">#&gt; Making plot for 8 overlays</span></span>
<span><span class="co">#&gt; Saving plot as: ~/Desktop/eXDR/viewOverlay/overlay1.png</span></span></code></pre></div>
<div class="figure" style="text-align: left">
<img src="viewOverlay.png" alt="**viewOverlay() output** - The objects are annotated with text showing the objectFlag type. The colors indicate which worm model was selected for the object." width="1913"><p class="caption">
<strong>viewOverlay() output</strong> - The objects are annotated with text showing the objectFlag type. The colors indicate which worm model was selected for the object.
</p>
</div>
<p><br> The <code>noFlag</code> objects look ok, but the wells are certainly dirty. Since the flags appear to be working we can retain these wells for now and move on. The full sized version of the overlay is saved to the example data directory that was cloned above.</p>
</div>
<div class="section level3">
<h3 id="filterof">
<code>filterOF</code><a class="anchor" aria-label="anchor" href="#filterof"></a>
</h3>
<p>Use the <code><a href="../reference/filterOF.html">filterOF()</a></code> function to remove all the flagged objects from the data after the flags have been checked. It is helpful to retain these data as a final processed object data set.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># finalize the object data made with outlierOF function above.</span></span>
<span><span class="va">proc.objs</span> <span class="op">&lt;-</span> <span class="fu">easyXpress</span><span class="fu">::</span><span class="fu"><a href="../reference/filterOF.html">filterOF</a></span><span class="op">(</span><span class="va">o</span>, rmVars <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">#&gt; 5 ObjectFlags detected in data. They were applied in the following order:</span></span>
<span><span class="co">#&gt; edge_ObjectFlag</span></span>
<span><span class="co">#&gt; cluster_ObjectFlag</span></span>
<span><span class="co">#&gt; user_ObjectFlag</span></span>
<span><span class="co">#&gt; classifier_ObjectFlag</span></span>
<span><span class="co">#&gt; outlier_ObjectFlag</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="summarizewells">
<code>summarizeWells</code><a class="anchor" aria-label="anchor" href="#summarizewells"></a>
</h3>
<p>The <code><a href="../reference/summarizeWells.html">summarizeWells()</a></code> function will remove flagged objects, summarize the data within each well and drop all object related variables from the data. These actions prepare the data for the next step, which is to flag wells.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># remove all flags, summarize wells, and drop object vars all in one function</span></span>
<span><span class="va">raw.wells</span> <span class="op">&lt;-</span> <span class="fu">easyXpress</span><span class="fu">::</span><span class="fu"><a href="../reference/summarizeWells.html">summarizeWells</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">o</span><span class="op">)</span></span>
<span><span class="co">#&gt; 5 ObjectFlags detected in data. They were applied in the following order:</span></span>
<span><span class="co">#&gt; edge_ObjectFlag</span></span>
<span><span class="co">#&gt; cluster_ObjectFlag</span></span>
<span><span class="co">#&gt; user_ObjectFlag</span></span>
<span><span class="co">#&gt; classifier_ObjectFlag</span></span>
<span><span class="co">#&gt; outlier_ObjectFlag</span></span>
<span><span class="co">#&gt; All flagged objects are filtered prior to summarizing wells.</span></span>
<span><span class="co">#&gt; The standard object variables are dropped from the summarized data.</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="flag-wells">Flag Wells<a class="anchor" aria-label="anchor" href="#flag-wells"></a>
</h2>
<p>Flag, check, and filter problematic wells, then check the experimental design balance after filtering.</p>
<div class="section level3">
<h3 id="titerwf">
<code>titerWF</code><a class="anchor" aria-label="anchor" href="#titerwf"></a>
</h3>
<p>Use the <code><a href="../reference/titerWF.html">titerWF()</a></code> function to check for improperly titered bleaches. This function will look across the control conditions within grouping variables and flag wells that belong to bleaches with extreme variation in worm numbers or <code>cv.n</code>. Previous analyses suggest that a <code>cv.n</code> &gt; 0.68 is a good threshold. Each set of experiments may require a different threshold, which can be set with the <code>thresh</code> parameter.</p>
<p>The first element of the retruned list <code>tf$d</code> is the flagged well data. A diagnotic plot is returned in the second element of the list <code>tf$p</code>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use the titerWF function within a particular bleach and drug for each strain</span></span>
<span><span class="va">tf</span> <span class="op">&lt;-</span> <span class="fu">easyXpress</span><span class="fu">::</span><span class="fu"><a href="../reference/titerWF.html">titerWF</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">raw.wells</span>,</span>
<span>                          <span class="va">Metadata_Experiment</span>, <span class="va">bleach</span>, <span class="va">strain</span>, <span class="va">drug</span>,</span>
<span>                          doseR <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">#&gt; You set doseR = TRUE. Expecting controls to be coded as for a dose response.</span></span>
<span><span class="co">#&gt; 34 independent bleaches detected. The titer_WellFlag is set in the output data.</span></span>
<span><span class="co">#&gt; A diagnostic plot for checking cv.n threshold is returned. See ?titerWF() for more details.</span></span>
<span></span>
<span><span class="co"># look at the diagnostic plot</span></span>
<span><span class="va">tf</span><span class="op">$</span><span class="va">p</span></span></code></pre></div>
<p><img src="Dose_Response_files/figure-html/unnamed-chunk-19-1.png" width="700" style="display: block; margin: auto;"><br> The diagnostic plot above shows that there is one bleach with large variation in worm number <code>cv.n &gt; 0.68</code>. All the wells from this bleach will be flagged.</p>
</div>
<div class="section level3">
<h3 id="nwf">
<code>nWF</code><a class="anchor" aria-label="anchor" href="#nwf"></a>
</h3>
<p>Use the <code><a href="../reference/nWF.html">nWF()</a></code> function to flag wells with too many or too few objects in them. In this example, the <code>min</code> argument is set to <code>3</code>, which will flag wells with less than 3 objects. The default value is <code>min = 5</code>, but because the example data is so sparse at the high concentrations of the toxicants the value is set lower.</p>
<p>The function will output a flagged data <code>n$d</code> and a dignostic plot <code>n$p</code> as the first and second elements of a list. The diagnostic plot is faceted by the grouping variables specified with <code>...</code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use the nWF function with the data output from the titerWF function above</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu">easyXpress</span><span class="fu">::</span><span class="fu"><a href="../reference/nWF.html">nWF</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">tf</span><span class="op">$</span><span class="va">d</span>, <span class="va">drug</span>, <span class="va">concentration_um</span>, max <span class="op">=</span> <span class="fl">30</span>, min <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; The n_WellFlag is set in the output data.</span></span>
<span><span class="co">#&gt; A diagnostic plot for checking the object number thresholds (max, min) is returned. See &lt;out&gt;$.p</span></span>
<span></span>
<span><span class="co"># Look at the diagnostic plot</span></span>
<span><span class="va">n</span><span class="op">$</span><span class="va">p</span></span></code></pre></div>
<p><img src="Dose_Response_files/figure-html/unnamed-chunk-20-1.png" width="960" style="display: block; margin: auto;"><br> The plot shows the distribution of object counts across the grouping variables with the <code>min</code> and <code>max</code> thresholds ploted as vertical lines.</p>
</div>
<div class="section level3">
<h3 id="outlierwf">
<code>outlierWF</code><a class="anchor" aria-label="anchor" href="#outlierwf"></a>
</h3>
<p>Use the <code><a href="../reference/outlierWF.html">outlierWF()</a></code> function to flag wells with extreme values of <code>median_wormlength_um</code> within the grouping variables specified with <code>...</code>. Typically the grouping variables should isolate strains, conditions, and independent bleaches, like in the example below.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use the outlierWF function to flag outliers within groups</span></span>
<span><span class="co"># then use dplyr::mutate to add a variable to indicate independent bleaches.</span></span>
<span><span class="va">ow</span> <span class="op">&lt;-</span> <span class="fu">easyXpress</span><span class="fu">::</span><span class="fu"><a href="../reference/outlierWF.html">outlierWF</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">n</span><span class="op">$</span><span class="va">d</span>,</span>
<span>                            <span class="va">Metadata_Experiment</span>, <span class="va">bleach</span>, <span class="va">drug</span>,</span>
<span>                            <span class="va">concentration_um</span>, <span class="va">strain</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>assay_bleach <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">Metadata_Experiment</span>, <span class="va">bleach</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Previously flagged wells will not be used when calcualting outliers within the group. This is the recommended approach.</span></span>
<span><span class="co">#&gt; 2 WellFlags detected in data. They were applied in the following order:</span></span>
<span><span class="co">#&gt; titer_WellFlag</span></span>
<span><span class="co">#&gt; n_WellFlag</span></span>
<span><span class="co">#&gt; Flagging outlier wells in group if median_wormlength_um is outside the range: median +/- (1.5*IQR)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="checkwf">
<code>checkWF</code><a class="anchor" aria-label="anchor" href="#checkwf"></a>
</h3>
<p>Use the <code><a href="../reference/checkWF.html">checkWF()</a></code> function to see how many wells are being flagged across grouping variables specified with <code>...</code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use the checkWF function</span></span>
<span><span class="va">cw1</span> <span class="op">&lt;-</span> <span class="fu">easyXpress</span><span class="fu">::</span><span class="fu"><a href="../reference/checkWF.html">checkWF</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ow</span>, <span class="va">drug</span>, <span class="va">concentration_um</span><span class="op">)</span></span>
<span><span class="co">#&gt; 3 WellFlags detected in data. They were applied in the following order:</span></span>
<span><span class="co">#&gt; titer_WellFlag</span></span>
<span><span class="co">#&gt; n_WellFlag</span></span>
<span><span class="co">#&gt; outlier_WellFlag</span></span>
<span><span class="co">#&gt; The data are summarized by: drug, concentration_um</span></span>
<span><span class="co">#&gt; Returning list with elements d (the summary data frame) and p (the summary plot)</span></span>
<span></span>
<span><span class="co"># look at the plot</span></span>
<span><span class="va">cw1</span><span class="op">$</span><span class="va">p</span></span></code></pre></div>
<p><img src="Dose_Response_files/figure-html/unnamed-chunk-22-1.png" width="960" style="display: block; margin: auto;"><br>The diagnostic plot above shows that large fraction of wells are being flagged in the highest Zinc concentration. We can use the<code><a href="../reference/filterWF.html">filterWF()</a></code> and <code><a href="../reference/checkBalance.html">checkBalance()</a></code> functions to see how much data is retained across grouping variables relative to the complete experimental design after the flags are filtered.</p>
</div>
<div class="section level3">
<h3 id="filterwf">
<code>filterWF</code><a class="anchor" aria-label="anchor" href="#filterwf"></a>
</h3>
<p>The <code><a href="../reference/filterWF.html">filterWF()</a></code> function will remove all the flagged wells from the data.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use the filterWF function and drop the flagging variables afterward</span></span>
<span><span class="va">fw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filterWF.html">filterWF</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ow</span>, rmVars <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">#&gt; 3 WellFlags detected in data. They were applied in the following order:</span></span>
<span><span class="co">#&gt; titer_WellFlag</span></span>
<span><span class="co">#&gt; n_WellFlag</span></span>
<span><span class="co">#&gt; outlier_WellFlag</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="checkbalance">
<code>checkBalance</code><a class="anchor" aria-label="anchor" href="#checkbalance"></a>
</h3>
<p>Use the <code><a href="../reference/checkBalance.html">checkBalance()</a></code> function to see the fraction of data retained after the flags are filtered. A balanced design is critical if the effects of confounding variables are to be regressed with the <code><a href="../reference/regEff.html">regEff()</a></code> function. The original design data is sourced from the <code>dr$design</code> object produced by the <code><a href="../reference/readXpress.html">readXpress()</a></code> function above. In the example below, the <code>dplyr</code> package is used to add the <code>assay_bleach</code> variable to the design data so that it can be joined with the data output form the <code><a href="../reference/outlierWF.html">outlierWF()</a></code> function and used as the x-axis in the resulting plot, see code chunk below.</p>
<p>The <code><a href="../reference/checkBalance.html">checkBalance()</a></code> function returns a list with summary data for making the plot as <code>cb$d</code> and the plot itself as <code>cb$p</code>.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use the checkBalance function and add assay_bleach var to design</span></span>
<span><span class="va">cb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/checkBalance.html">checkBalance</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fw</span>, <span class="va">drug</span>, <span class="va">concentration_um</span>,</span>
<span>                   design <span class="op">=</span> <span class="va">dr</span><span class="op">$</span><span class="va">design</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>                     <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>assay_bleach <span class="op">=</span></span>
<span>                                     <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">Metadata_Experiment</span>, <span class="va">bleach</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                   x <span class="op">=</span> <span class="va">assay_bleach</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining, by = c("well.id", "assay_bleach", "drug", "concentration_um")</span></span>
<span><span class="co">#&gt; Returning list with elements d (the summary data frame) and p (the summary plot)</span></span>
<span></span>
<span><span class="co"># Look at the plot and add a nicer x-axis with ggplot2 package</span></span>
<span><span class="va">cb</span><span class="op">$</span><span class="va">p</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0.75</span>, linetype <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Dose_Response_files/figure-html/unnamed-chunk-24-1.png" width="960" style="display: block; margin: auto;"><br> The plot above shows that the flagged data fall in particular bleaches. We recommend that the independent bleaches with less than 75 % of data retained be removed. Based on this plot, the bleaches that should be removed for each drug are listed below.<br><strong>1. Paraquat</strong> - The four bleaches <code>toxin14A_2</code>, <code>toxin14A_3</code>, <code>toxin15A_1</code>, and <code>toxin15A_3</code> should be removed.<br><strong>2. Zinc dichloride</strong> - The five bleaches <code>toxin14A_1</code>, <code>toxin14A_2</code>, <code>toxin15A_1</code>, <code>toxin15A_3</code>, and <code>toxin22A_3</code> should be removed.<br></p>
</div>
<div class="section level3">
<h3 id="checkeff">
<code>checkEff</code><a class="anchor" aria-label="anchor" href="#checkeff"></a>
</h3>
<p>The <code><a href="../reference/checkEff.html">checkEff()</a></code> function is used to look at the data after the problematic bleaches have been removed. For more help with the <code><a href="../reference/checkEff.html">checkEff()</a></code> function use <code>?checkEff()</code>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># filter the unbalanced bleaches - nearly half the data in this example.</span></span>
<span><span class="va">drop</span> <span class="op">&lt;-</span> <span class="va">fw</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>b.filter <span class="op">=</span></span>
<span>                  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">drug</span> <span class="op">==</span> <span class="st">"Paraquat"</span> <span class="op">&amp;</span><span class="va">assay_bleach</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span></span>
<span>                                     <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"toxin14A_2"</span>,</span>
<span>                                       <span class="st">"toxin14A_3"</span>,</span>
<span>                                       <span class="st">"toxin15A_1"</span>,</span>
<span>                                       <span class="st">"toxin15A_3"</span><span class="op">)</span> <span class="op">~</span>  <span class="st">"drop"</span>,</span>
<span>                                   <span class="va">drug</span> <span class="op">==</span> <span class="st">"Zinc dichloride"</span> <span class="op">&amp;</span> <span class="va">assay_bleach</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span></span>
<span>                                     <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"toxin14A_1"</span>,</span>
<span>                                       <span class="st">"toxin14A_2"</span>,</span>
<span>                                       <span class="st">"toxin15A_1"</span>,</span>
<span>                                       <span class="st">"toxin15A_3"</span>,</span>
<span>                                       <span class="st">"toxin22A_3"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"drop"</span>,</span>
<span>                                   <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"keep"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">b.filter</span> <span class="op">==</span> <span class="st">"keep"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">b.filter</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># use the checkEff function</span></span>
<span><span class="va">ce1</span> <span class="op">&lt;-</span> <span class="fu">easyXpress</span><span class="fu">::</span><span class="fu"><a href="../reference/checkEff.html">checkEff</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">drop</span>,</span>
<span>                            <span class="va">drug</span>, <span class="va">strain</span>,</span>
<span>                            x <span class="op">=</span> <span class="va">concentration_um</span>,</span>
<span>                            y <span class="op">=</span> <span class="va">median_wormlength_um</span>,</span>
<span>                            fill <span class="op">=</span> <span class="va">assay_bleach</span>,</span>
<span>                            scales <span class="op">=</span> <span class="st">"free_x"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Using `as.character()` on a quosure is deprecated as of rlang 0.3.0.</span></span>
<span><span class="co">#&gt; Please use `as_label()` or `as_name()` instead.</span></span>
<span></span>
<span><span class="co"># look at the plot</span></span>
<span><span class="va">ce1</span></span></code></pre></div>
<p><img src="Dose_Response_files/figure-html/unnamed-chunk-25-1.png" width="700" style="display: block; margin: auto;"><br> The dose effect is as expected for the two strains, increasing concentrations of toxicants reduce the length of animals in the wells. There could be an effect of assay and bleach that can be tested with the <code><a href="../reference/regEff.html">regEff()</a></code> function.</p>
</div>
</div>
<div class="section level2">
<h2 id="finalize-results">Finalize Results<a class="anchor" aria-label="anchor" href="#finalize-results"></a>
</h2>
<div class="section level3">
<h3 id="regeff">
<code>regEff</code><a class="anchor" aria-label="anchor" href="#regeff"></a>
</h3>
<p>The <code><a href="../reference/regEff.html">regEff()</a></code> function will regress out the effect of a confounding variable on a dependent variable within groups specified by <code>...</code>. The function extracts the residuals of a linear model specified as <code>d.var ~ c.var - 1</code> that remove the estimated influence of the confounding variable <code>c.var</code> on the dependent variable <code>d.var</code>. The function returns a list with four elements. the residuals of the method should be used carefully as it can introduce noise into data awill also produce diagnostic plots and We recommend testing</p>
<p>Before using the <code><a href="../reference/regEff.html">regEff()</a></code> function it is important to have a well balanced design. If the effect of bleach</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Regress the effect of independent bleaches for each drug using regEff()</span></span>
<span><span class="va">reg</span> <span class="op">&lt;-</span> <span class="fu">easyXpress</span><span class="fu">::</span><span class="fu"><a href="../reference/regEff.html">regEff</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">drop</span>,</span>
<span>                          <span class="va">drug</span>,</span>
<span>                          d.var <span class="op">=</span> <span class="va">median_wormlength_um</span>,</span>
<span>                          c.var <span class="op">=</span> <span class="va">assay_bleach</span><span class="op">)</span></span>
<span><span class="co">#&gt; The dependent variable `median_wormlength_um` is class numeric. Please ensure this is correct.</span></span>
<span><span class="co">#&gt; The confounding variable `assay_bleach` is class character. Please ensure this is correct.</span></span>
<span><span class="co">#&gt; The data are grouped by: `drug`</span></span>
<span></span>
<span><span class="co"># Look at the regression coefficients in the diagnostic plot p2</span></span>
<span><span class="va">reg</span><span class="op">$</span><span class="va">p2</span></span></code></pre></div>
<p><img src="Dose_Response_files/figure-html/unnamed-chunk-26-1.png" width="700" style="display: block; margin: auto;"><br> The diagnostic plot above shows the point estimates of regression coefficients for each of the indepedent bleaches faceted by drug with standard errors as lines. We recommend further filtering bleaches with extreme effects. Here there are no extreme bleach effects to filter.</p>
</div>
<div class="section level3">
<h3 id="delta">
<code>delta</code><a class="anchor" aria-label="anchor" href="#delta"></a>
</h3>
<p>The <code><a href="../reference/delta.html">delta()</a></code> function is used to control for innate differences among strains. This function will calculate the difference in well summary statistics between the experimental condition and the median control condition within a group. It is recommended to group data to independent bleaches for all strains and drugs when processing dose response data.</p>
<p>This is the final step in processing the data. See the help for the <code><a href="../reference/delta.html">delta()</a></code> function with <code>?delta()</code>.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use the delta() function</span></span>
<span><span class="va">del</span> <span class="op">&lt;-</span> <span class="fu">easyXpress</span><span class="fu">::</span><span class="fu"><a href="../reference/delta.html">delta</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">reg</span><span class="op">$</span><span class="va">d</span>,</span>
<span>                         <span class="va">assay_bleach</span>, <span class="va">drug</span>, <span class="va">strain</span>, <span class="co"># group with ...</span></span>
<span>                         WF <span class="op">=</span> <span class="st">"filter"</span>,</span>
<span>                         doseR <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                         vars <span class="op">=</span> <span class="st">"median_wormlength_um_reg"</span><span class="op">)</span></span>
<span><span class="co">#&gt; You set doseR = TRUE. Expecting controls to be coded as for a dose response.</span></span>
<span><span class="co">#&gt; No flagged wells detected.</span></span>
<span><span class="co">#&gt; The data are grouped by, assay_bleach, drug, strain.</span></span>
<span><span class="co">#&gt; The mean control value within groups has been subtracted from the well summary statstics:</span></span>
<span><span class="co">#&gt; median_wormlength_um_reg</span></span>
<span></span>
<span><span class="co"># check the finalized data</span></span>
<span><span class="fu"><a href="../reference/checkEff.html">checkEff</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">del</span>, <span class="va">drug</span>, <span class="va">strain</span>, x <span class="op">=</span> <span class="va">concentration_um</span>,</span>
<span>         y <span class="op">=</span> <span class="va">median_wormlength_um_reg_delta</span>,</span>
<span>         fill <span class="op">=</span> <span class="va">assay_bleach</span>,</span>
<span>         scales <span class="op">=</span> <span class="st">"free_x"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Dose_Response_files/figure-html/unnamed-chunk-27-1.png" width="700"><br> The finalized data can be used to fit dose response curves with the `dr</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Tim Crombie, Joy Nyaanga, Sam Widmayer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
